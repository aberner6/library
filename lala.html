<!DOCTYPE html>
<meta charset="utf-8">
<head>
<link href="css/tipsy.css" rel="stylesheet" type="text/css" /> 
	</head>
<body>
<script type="text/javascript" src="js/lib/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/lib/jquery.tipsy.js"></script>
<script type="text/javascript" src="js/lib/d3.v3.js"></script>
<script>
var freqscale = 5; //size of circles
var  MAX_LEVELS = 10; //number larger than number of levels of circles
var radius_levels = [0, 0, 240, 180, 125, 70, 15, 0, 0, 0]; //how far away from the center each level is
var subradius = 250; 
var MIN_LINE = 3.0; //length of the little ones
var TEXT_PAD_X = 5;
var TEXT_PAD_Y = 2;
var LEGEND_X_MARGIN = 20;
var LEGEND_SCALE = 0.003;

//  Make an array of Subjects
var subjects;
//  Make an array of Connections
var connections;

var bcolor;
var subtext;
var hsubtext;
var concolor;
var hconcolor;
var legendconcolor;
  bcolor = "rgba(0, 0, 0, 255)";
  concolor = "rgba(210, 210, 210, 50)";
  hconcolor = "rgba(210, 210, 210, 100)";
  legendconcolor = "rgba(210, 210, 210, 75)";
  subtext = "rgba(150, 150, 150, 255)";
  hsubtext = "rgba(210, 210, 210, 255)";

var margin = {top: 20, right: 20, bottom: 30, left: 50},
    width = 1280 - margin.left - margin.right,
    height = 750 - margin.top - margin.bottom;

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height*2 + margin.top + margin.bottom);
        // .attr("transform", "translate(" + margin.left + "," + margin.top + ")");







// var angles = []
d3.tsv("connectionfreqcodes.txt", function(error, cData) {
console.log(cData);
var counters = [0,0,146,106,33,14,2,0,0,0];
var jumps;
var angles;
var q;
// var subIx;
for (i = 0; i < MAX_LEVELS;i++) {
    jumps = Math.PI*2/parseFloat(counters[i]);  
}
for (i = 0; i < cData.length;i++) {
	q = cData[i].codeName;
	angles=cData[i].angles;
// console.log(q.length);
// console.log(angles[i]);
for (j = 0; j<q.length; j++){
	subIx = q[i]-1;
}
// console.log(angles)
// console.log(angles[q.length]);
}
    // float angle = angles[q.length];
    // float radius = radius_levels[q.length];
    // c.pos.x = width*0.5+radius*cos(angle);
    // c.pos.y = height*0.5+radius*sin(angle);
var inCircle = svg.selectAll("circle")
	.data(cData)
	.enter().append("circle")
	.attr("class", "inCircle")
	.attr("cx", function(d,i){
		// console.log()
     return width*0.5+d.radiusIs*Math.cos(d.angles);
		// console.log(d.codeName);
	})
	.attr("cy", function(d){ 
		return height*0.5+d.radiusIs*Math.sin(d.angles);
	})
	.attr("r", function(d){
		return Math.log(d.freq+2.0)*freqscale/2;
	})
	.attr("fill","none")
	.attr("stroke","lightgray")

})










d3.tsv("subjects.tsv", function(error, data) {
console.log(data);
var jump = Math.PI*2/data.length;
var angle = 0;

var surroundingCircles = svg.selectAll("surroundingCircles")
	.data(data)
	.enter().append("circle")
	.attr("class", "surroundingCircles")
	.attr("cx", function(d,i){
  		// return i*50;
     return width*0.5+subradius*1.3*Math.cos(jump*(d.loc - 1));
	})
	.attr("cy", function(d,i){   
		// return height/2;
     return height*0.5+subradius*1.3*Math.sin(jump*(d.loc - 1));

	})
	.attr("r", function(d){ 
		return Math.log(d.freq+2.0)*freqscale/2;
	})
	.attr("fill", function(d){
		return "rgba("+d.loc*20+",100,100,.5)";
})
$('.surroundingCircles').tipsy({ 
        gravity: 'nw', 
        html: true, 
        //fade: true,
        title: function() {
          var d = this.__data__;
          // console
          return d.subject+" ("+d.freq+")";
          // var intit = parseInt(d.score);
          // return (intit)+" pts";
        }
});
})

</script>
</body>
